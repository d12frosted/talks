% Created 2019-10-17 Thu 20:10
% Intended LaTeX compiler: pdflatex
\documentclass[presentation,aspectratio=169,smaller]{beamer}
\usepackage[utf8x]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage{grffile}
\usepackage{longtable}
\usepackage{wrapfig}
\usepackage{rotating}
\usepackage[normalem]{ulem}
\usepackage{amsmath}
\usepackage{textcomp}
\usepackage{amssymb}
\usepackage{capt-of}
\usepackage{hyperref}
\usepackage{color}
\usepackage[newfloat]{minted}
\usepackage[utf8]{inputenc}
\usepackage{soul}
\usepackage{unicode-math}
\usepackage{mathtools}
\usepackage[mathletters]{ucs}
\usemintedstyle{tango}
\setminted{fontsize=\scriptsize}
\setminted{mathescape=true}
\setbeamertemplate{itemize items}[circle]
\setbeamertemplate{enumerate items}[default]
\setlength{\parskip}{\baselineskip}%
\setlength{\parindent}{0pt}%
\setbeamertemplate{navigation symbols}{}%remove navigation symbols
\newcommand{\hlyellow}[1]{\colorbox{yellow!50}{$\displaystyle#1$}}
\newcommand{\hlfancy}[2]{\sethlcolor{#1}\hl{#2}}
\usetheme{default}
\author{Boris Buliga}
\date{\today}
\title{Universe of zippers (or how to plant a bomb)}
\hypersetup{
 pdfauthor={Boris Buliga},
 pdftitle={Universe of zippers (or how to plant a bomb)},
 pdfkeywords={},
 pdfsubject={},
 pdfcreator={Emacs 26.3 (Org mode 9.2.6)}, 
 pdflang={English}}
\begin{document}

\maketitle
\newcommand{\mathcolorbox}[2]{%
  \begingroup
  \setlength{\fboxsep}{2pt}%
  \colorbox{#1}{$\displaystyle #2$}%
  \endgroup
}

\AtBeginSection[]{
  \begin{frame}
  \vfill
  \centering
  \begin{beamercolorbox}[sep=8pt,center,shadow=true,rounded=true]{title}
    \usebeamerfont{title}\insertsectionhead\par%
  \end{beamercolorbox}
  \vfill
  \end{frame}
}

\section*{Intro}
\label{sec:orge987d52}
\begin{frame}[label={sec:org81e5ecb}]{About me}
\begin{columns}
\begin{column}{0.75\columnwidth}
\begin{itemize}
\item Server developer @Wix.
\item Haskell â†” Emacs Lisp extremist. Whatever that means.
\item Chinese tea lover.
\item Wine-lifestyle activist (92\% of my life).
\end{itemize}
\end{column}

\begin{column}{0.25\columnwidth}
\begin{center}
\includegraphics[height=3.5cm]{images/boris.jpg}
\end{center}
\end{column}
\end{columns}
\end{frame}

\begin{frame}[label={sec:org82d154b}]{Agenda}
\begin{itemize}
\item <1-> Cellular Automata
\begin{itemize}
\item Elementary CA
\item Conway's game of life
\end{itemize}
\item <2-> Bomberman
\item <3-> Secret abstraction
\end{itemize}
\end{frame}

\section{Act 1: Elementary Cellular Automata}
\label{sec:orge6d510e}

\begin{frame}[label={sec:org89037fa}]{Cellular Automaton}
A cellular automaton is a collection of "colored" \alert{cells} on a \alert{grid} of
specified shape that evolves through a number of discrete time \alert{steps} according
to a set of \alert{rules} based on the states of neighboring cells.

The rules are then applied \emph{iteratively} for as many time steps as desired.
\end{frame}

\begin{frame}[label={sec:orgea1d873}]{Many grids}
\begin{enumerate}
\item one-dimensional line;
\item rectangle grid;
\item square grid;
\item triangular grid;
\item hexagonal grid;
\item d-dimensional integer lattice.
\end{enumerate}
\end{frame}

\begin{frame}[label={sec:org0635230},t]{Elementary Cellular Automata}
\begin{onlyenv}<1->
The simplest class of one-dimensional cellular automata.
\end{onlyenv}

\begin{onlyenv}<2->
Each cell has a value \(a \in \lbrace 0, 1 \rbrace = \lbrace \square, \blacksquare
\rbrace\)
\end{onlyenv}

\begin{onlyenv}<3->
\hfill \dots
\square \blacksquare \blacksquare \square \square \square \blacksquare
\dots \hfill
\end{onlyenv}

\begin{onlyenv}<4->
\begin{equation*}
  \begingroup
  \setlength\arraycolsep{0.25pt}
  \renewcommand{\arraystretch}{0.5}
  \begin{matrix}
    \blacksquare & \blacksquare & \blacksquare \\
    & \square &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \blacksquare & \blacksquare & \square \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \blacksquare & \square & \blacksquare \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \blacksquare & \square & \square \\
    & \square &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \blacksquare & \blacksquare \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \blacksquare & \square \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \square & \blacksquare \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \square & \square \\
    & \square &
  \end{matrix}
  \endgroup
\end{equation*}
\end{onlyenv}
\end{frame}

\begin{frame}[label={sec:org7c6c603},t]{Evolution example}
\begin{onlyenv}<1-3>
Current automation contents

\begin{equation*}
  \hfill
  \dots
  \square
  \blacksquare
  \blacksquare
  \square
  \square
  \square
  \blacksquare
  \dots
  \hfill
\end{equation*}
\end{onlyenv}

\begin{onlyenv}<2-3>
Rule \(110\) (\(01101110\))

\begin{equation*}
  \begingroup
  \setlength\arraycolsep{0.25pt}
  \renewcommand{\arraystretch}{0.5}
  \begin{matrix}
    \blacksquare & \blacksquare & \blacksquare \\
    & \square &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \blacksquare & \blacksquare & \square \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \blacksquare & \square & \blacksquare \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \blacksquare & \square & \square \\
    & \square &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \blacksquare & \blacksquare \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \blacksquare & \square \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \square & \blacksquare \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \square & \square \\
    & \square &
  \end{matrix}
  \endgroup
\end{equation*}
\end{onlyenv}

\begin{onlyenv}<3>
The next generation of the automation

\hfill \dots
\mspace{14mu} \mspace{14mu} \mspace{14mu} \mspace{14mu} \mspace{14mu} \mspace{14mu} \mspace{14mu}
\dots \hfill
\end{onlyenv}

\begin{onlyenv}<4>
Current automation contents

\begin{equation*}
  \hfill
  \dots
  \mathcolorbox{yellow}{%
    \square%
    \blacksquare%
  }%
  \blacksquare
  \square
  \square
  \square
  \blacksquare
  \dots
  \hfill
\end{equation*}

Rule \(110\) (\(01101110\))

\begin{equation*}
  \begingroup
  \setlength\arraycolsep{0.25pt}
  \renewcommand{\arraystretch}{0.5}
  \begin{matrix}
    \blacksquare & \blacksquare & \blacksquare \\
    & \square &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \blacksquare & \blacksquare & \square \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \blacksquare & \square & \blacksquare \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \blacksquare & \square & \square \\
    & \square &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \blacksquare & \blacksquare \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \blacksquare & \square \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \mathcolorbox{yellow}{
    \begin{matrix}
      \square & \square & \blacksquare \\
      & \blacksquare &
    \end{matrix}
  }\mspace{28mu}
  \begin{matrix}
    \square & \square & \square \\
    & \square &
  \end{matrix}
  \endgroup
\end{equation*}

The next generation of the automation

\hfill \dots
\mathcolorbox{yellow}{\blacksquare}
\mspace{14mu}
\mspace{14mu}
\mspace{14mu}
\mspace{14mu}
\mspace{14mu}
\mspace{14mu}
\dots \hfill
\end{onlyenv}

\begin{onlyenv}<5>
Current automation contents

\begin{equation*}
  \hfill
  \dots
  \mathcolorbox{yellow}{
    \square
    \blacksquare
    \blacksquare
  }
  \square
  \square
  \square
  \blacksquare
  \dots
  \hfill
\end{equation*}

Rule \(110\) (\(01101110\))

\begin{equation*}
  \begingroup
  \setlength\arraycolsep{0.25pt}
  \renewcommand{\arraystretch}{0.5}
  \begin{matrix}
    \blacksquare & \blacksquare & \blacksquare \\
    & \square &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \blacksquare & \blacksquare & \square \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \blacksquare & \square & \blacksquare \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \blacksquare & \square & \square \\
    & \square &
  \end{matrix}\mspace{28mu}
  \mathcolorbox{yellow}{
    \begin{matrix}
      \square & \blacksquare & \blacksquare \\
      & \blacksquare &
    \end{matrix}
  }\mspace{28mu}
  \begin{matrix}
    \square & \blacksquare & \square \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \square & \blacksquare \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \square & \square \\
    & \square &
  \end{matrix}
  \endgroup
\end{equation*}

The next generation of the automation

\hfill \dots
\blacksquare
\mathcolorbox{yellow}{\blacksquare}
\mspace{14mu}
\mspace{14mu}
\mspace{14mu}
\mspace{14mu}
\mspace{14mu}
\dots \hfill
\end{onlyenv}

\begin{onlyenv}<6>
Current automation contents

\begin{equation*}
  \hfill
  \dots
  \square
  \mathcolorbox{yellow}{
    \blacksquare
    \blacksquare
    \square
  }
  \square
  \square
  \blacksquare
  \dots
  \hfill
\end{equation*}

Rule \(110\) (\(01101110\))

\begin{equation*}
  \begingroup
  \setlength\arraycolsep{0.25pt}
  \renewcommand{\arraystretch}{0.5}
  \begin{matrix}
    \blacksquare & \blacksquare & \blacksquare \\
    & \square &
  \end{matrix}\mspace{28mu}
  \mathcolorbox{yellow}{
    \begin{matrix}
      \blacksquare & \blacksquare & \square \\
      & \blacksquare &
    \end{matrix}
  }\mspace{28mu}
  \begin{matrix}
    \blacksquare & \square & \blacksquare \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \blacksquare & \square & \square \\
    & \square &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \blacksquare & \blacksquare \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \blacksquare & \square \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \square & \blacksquare \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \square & \square \\
    & \square &
  \end{matrix}
  \endgroup
\end{equation*}

The next generation of the automation

\hfill \dots
\blacksquare
\blacksquare
\mathcolorbox{yellow}{\blacksquare}
\mspace{14mu}
\mspace{14mu}
\mspace{14mu}
\dots \hfill
\end{onlyenv}

\begin{onlyenv}<7>
Current automation contents

\begin{equation*}
  \hfill
  \dots
  \square
  \blacksquare
  \mathcolorbox{yellow}{
    \blacksquare
    \square
    \square
  }
  \square
  \blacksquare
  \dots
  \hfill
\end{equation*}

Rule \(110\) (\(01101110\))

\begin{equation*}
  \begingroup
  \setlength\arraycolsep{0.25pt}
  \renewcommand{\arraystretch}{0.5}
  \begin{matrix}
    \blacksquare & \blacksquare & \blacksquare \\
    & \square &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \blacksquare & \blacksquare & \square \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \blacksquare & \square & \blacksquare \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \mathcolorbox{yellow}{
    \begin{matrix}
      \blacksquare & \square & \square \\
      & \square &
    \end{matrix}
  }\mspace{28mu}
  \begin{matrix}
    \square & \blacksquare & \blacksquare \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \blacksquare & \square \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \square & \blacksquare \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \square & \square \\
    & \square &
  \end{matrix}
  \endgroup
\end{equation*}

The next generation of the automation

\hfill \dots
\blacksquare
\blacksquare
\blacksquare
\mathcolorbox{yellow}{\square}
\mspace{14mu}
\mspace{14mu}
\mspace{14mu}
\dots \hfill
\end{onlyenv}

\begin{onlyenv}<8>
Current automation contents

\begin{equation*}
  \hfill
  \dots
  \square
  \blacksquare
  \blacksquare
  \mathcolorbox{yellow}{
    \square
    \square
    \square
  }
  \blacksquare
  \dots
  \hfill
\end{equation*}

Rule \(110\) (\(01101110\))

\begin{equation*}
  \begingroup
  \setlength\arraycolsep{0.25pt}
  \renewcommand{\arraystretch}{0.5}
  \begin{matrix}
    \blacksquare & \blacksquare & \blacksquare \\
    & \square &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \blacksquare & \blacksquare & \square \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \blacksquare & \square & \blacksquare \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \blacksquare & \square & \square \\
    & \square &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \blacksquare & \blacksquare \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \blacksquare & \square \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \square & \blacksquare \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \mathcolorbox{yellow}{
    \begin{matrix}
      \square & \square & \square \\
      & \square &
    \end{matrix}
  }
  \endgroup
\end{equation*}

The next generation of the automation

\hfill \dots
\blacksquare
\blacksquare
\blacksquare
\square
\mathcolorbox{yellow}{\square}
\mspace{14mu}
\mspace{14mu}
\dots \hfill
\end{onlyenv}

\begin{onlyenv}<9>
Current automation contents

\begin{equation*}
  \hfill
  \dots
  \square
  \blacksquare
  \blacksquare
  \square
  \mathcolorbox{yellow}{
    \square
    \square
    \blacksquare
  }
  \dots
  \hfill
\end{equation*}

Rule \(110\) (\(01101110\))

\begin{equation*}
  \begingroup
  \setlength\arraycolsep{0.25pt}
  \renewcommand{\arraystretch}{0.5}
  \begin{matrix}
    \blacksquare & \blacksquare & \blacksquare \\
    & \square &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \blacksquare & \blacksquare & \square \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \blacksquare & \square & \blacksquare \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \blacksquare & \square & \square \\
    & \square &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \blacksquare & \blacksquare \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \blacksquare & \square \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \mathcolorbox{yellow}{
    \begin{matrix}
      \square & \square & \blacksquare \\
      & \blacksquare &
    \end{matrix}
  }\mspace{28mu}
  \begin{matrix}
    \square & \square & \square \\
    & \square &
  \end{matrix}
  \endgroup
\end{equation*}

The next generation of the automation

\hfill \dots
\blacksquare
\blacksquare
\blacksquare
\square
\square
\mathcolorbox{yellow}{\blacksquare}
\mspace{14mu}
\dots \hfill
\end{onlyenv}

\begin{onlyenv}<10>
Current automation contents

\begin{equation*}
  \hfill
  \dots
  \square
  \blacksquare
  \blacksquare
  \square
  \square
  \mathcolorbox{yellow}{
    \square
    \blacksquare
  }
  \dots
  \hfill
\end{equation*}

Rule \(110\) (\(01101110\))

\begin{equation*}
  \begingroup
  \setlength\arraycolsep{0.25pt}
  \renewcommand{\arraystretch}{0.5}
  \begin{matrix}
    \blacksquare & \blacksquare & \blacksquare \\
    & \square &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \blacksquare & \blacksquare & \square \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \blacksquare & \square & \blacksquare \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \blacksquare & \square & \square \\
    & \square &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \blacksquare & \blacksquare \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \mathcolorbox{yellow}{
    \begin{matrix}
      \square & \blacksquare & \square \\
      & \blacksquare &
    \end{matrix}
  }\mspace{28mu}
  \begin{matrix}
    \square & \square & \blacksquare \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \square & \square \\
    & \square &
  \end{matrix}
  \endgroup
\end{equation*}

The next generation of the automation

\hfill \dots
\blacksquare
\blacksquare
\blacksquare
\square
\square
\square
\mathcolorbox{yellow}{\blacksquare}
\dots \hfill
\end{onlyenv}

\begin{onlyenv}<11>
Current automation contents

\begin{equation*}
  \hfill
  \dots
  \square
  \blacksquare
  \blacksquare
  \square
  \square
  \square
  \blacksquare
  \dots
  \hfill
\end{equation*}

Rule \(110\) (\(01101110\))

\begin{equation*}
  \begingroup
  \setlength\arraycolsep{0.25pt}
  \renewcommand{\arraystretch}{0.5}
  \begin{matrix}
    \blacksquare & \blacksquare & \blacksquare \\
    & \square &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \blacksquare & \blacksquare & \square \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \blacksquare & \square & \blacksquare \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \blacksquare & \square & \square \\
    & \square &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \blacksquare & \blacksquare \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \blacksquare & \square \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \square & \blacksquare \\
    & \blacksquare &
  \end{matrix}\mspace{28mu}
  \begin{matrix}
    \square & \square & \square \\
    & \square &
  \end{matrix}
  \endgroup
\end{equation*}

The next generation of the automation

\hfill \dots
\blacksquare
\blacksquare
\blacksquare
\square
\square
\square
\blacksquare
\dots \hfill
\end{onlyenv}
\end{frame}

\begin{frame}[label={sec:org63f19d7}]{There is more about ECA}
\begin{itemize}
\item There are \(256\) possible rules.
\item Rule 110 is Turing complete.
\item There are many ways to encode the rules.
\item There are many ways to program ECA.
\end{itemize}
\end{frame}

\begin{frame}[label={sec:org2f7db3c},fragile]{Universe}
 \begin{minted}[]{haskell}
data U a = U [a] a [a]
--            |  |  |
--            |  |  ^ entries on the right side of the focus
--            |  ^ focus of the universe
--            ^ entries on the left side of the focus, reversed
\end{minted}

\pause

\begin{minted}[]{haskell}
> U [-1, -2, -3] 0 [1,2,3,4]
[-3, -2, -1] (0) [1, 2, 3, 4]
\end{minted}

\pause

\begin{minted}[]{haskell}
> U [(-1)..] 0 [1..]
[..., -3, -2, -1] (0) [1, 2, 3, ...]
-- infinite list, you can't just print it out
\end{minted}
\end{frame}

\begin{frame}[label={sec:orgc982d9c}]{Reversed left?}
\begin{itemize}
\item Fast access. We care about focused element and its neighbours.
\item Fast focus shifts.
\item Supports infinite universe around focused element (like you care).
\end{itemize}
\end{frame}

\begin{frame}[label={sec:org9610b61},fragile]{\texttt{fromList}}
 \begin{minted}[]{haskell}
fromList :: a -> [a] -> U a
fromList d []     = U (repeat d) d (repeat d)
fromList d (x:xs) = U (repeat d) x (xs ++ repeat d)

> fromList 0 [1, 2, 3]
[..., 0, 0, 0] (1) [2, 3, 0, 0, ...]
\end{minted}
\end{frame}

\begin{frame}[label={sec:orgbcce3ac},fragile]{Clearly a \texttt{Functor}}
 \begin{minted}[]{haskell}
instance Functor U where
  fmap f (U l c r) = U (fmap f l) (f c) (fmap f r)
\end{minted}

\pause

\texttt{DeriveFunctor} can do it for us.

\pause

\begin{minted}[]{haskell}
> abs <$> U [-1, -2, -3] 0 [1, 2, 3, 4]
[3, 2, 1] (0) [1, 2, 3, 4]

> (/0) <$> U [-1, -2, -3] 0 [1, 2, 3, 4]
[-Infinity, -Infinity, -Infinity] (NaN) [Infinity, Infinity, Infinity, Infinity]
\end{minted}
\end{frame}

\begin{frame}[label={sec:orgb3f3ddf},fragile]{\texttt{extract}}
 \begin{minted}[]{haskell}
extract :: U a -> a
extract (U _ a _) = a
\end{minted}

\pause

\begin{minted}[]{haskell}
> U ["drunk", "hello"] "folks" ["!"]
[hello, drunk] (folks) [!]

> extract $ U ["drunk", "hello"] "folks" ["!"]
"folks"
\end{minted}

\pause

\begin{minted}[]{haskell}
> extract $ U [(-1)..] 0 [1..]
0
\end{minted}
\end{frame}

\begin{frame}[label={sec:org9b5165b},fragile]{Moving left}
 \begin{minted}[]{haskell}
left :: U a -> U a
left (U (l:ls) c rs) = U ls l (c:rs)
\end{minted}

\pause

\begin{minted}[]{haskell}
> left $ U ["drunk", "hello"] "folks" ["!"]
[hello] (drunk) [folks, !]

> extract . left $ U ["drunk", "hello"] "folks" ["!"]
"drunk"
\end{minted}
\end{frame}

\begin{frame}[label={sec:orgf707260},fragile]{Moving right}
 \begin{minted}[]{haskell}
right :: U a -> U a
right right (U ls c (r:rs)) = U (c:ls) r rs
\end{minted}

\pause

\begin{minted}[]{haskell}
> right $ U ["drunk", "hello"] "folks" ["!"]
[hello, drunk, folks] (!) []

> extract . right $ U ["drunk", "hello"] "folks" ["!"]
"!"
\end{minted}
\end{frame}

\begin{frame}[label={sec:orgc57e313},fragile]{Non-totality}
 \begin{minted}[]{haskell}
> extract . right . right $ U ["drunk", "hello"] "folks" ["!"]
"*** Exception: <interactive>:23:5-41: Non-exhaustive patterns in function right
\end{minted}

Non-total functions are Judahs of modern world. We can accept and forgive them
in various ways:

\begin{enumerate}
\item Do nothing when there is nowhere to move.
\item Maybify them.
\end{enumerate}
\end{frame}

\begin{frame}[label={sec:org261c707},fragile]{Defining ECA}
 \begin{minted}[]{haskell}
data Cell
  = Dead
  | Alive

type ECA = U Cell
\end{minted}

\pause

\begin{minted}[,escapeinside=||,mathescape=true]{haskell}
> U [Alive, Dead] Alive [Alive, Dead]
|$\square\blacksquare\blacksquare\blacksquare\square$|

> fromList Dead [Dead, Alive, Alive, Alive, Dead]
...|$\square$\square$\square\blacksquare\blacksquare\blacksquare\square$\square$\square$|...
\end{minted}
\end{frame}

\begin{frame}[label={sec:org57ba1f9},fragile]{Defining rule}
 Rule says how to evolve a cell with respect to it's context.

\pause

\begin{minted}[]{haskell}
type Rule = U a -> a
type ECARule = U Cell -> Cell
\end{minted}
\end{frame}

\begin{frame}[label={sec:org8d9513c},fragile]{Rule 110}
 \begin{minted}[]{haskell}
rule110 :: U Cell -> Cell
rule110 u = case extract3 Dead u of
  (Dead  , Dead  , Dead)  -> Dead
  (Dead  , Dead  , Alive) -> Alive
  (Dead  , Alive , Dead)  -> Alive
  (Dead  , Alive , Alive) -> Alive
  (Alive , Dead  , Dead)  -> Dead
  (Alive , Dead  , Alive) -> Alive
  (Alive , Alive , Dead)  -> Alive
  (Alive , Alive , Alive) -> Dead

extract3 :: Cell -> U Cell -> (Cell, Cell, Cell)
extract3 c u = case maybe c extract . ($ u) <$> [maybeLeft, Just, maybeRight] of
  [l, c, r] -> (l, c, r)
\end{minted}

\pause

\begin{minted}[,escapeinside=||,mathescape=true]{haskell}
> rule110 $ U ([Alive, Dead, Alive] <> repeat Dead) Alive ([Dead, Alive] <> repeat Dead)
|$\blacksquare$|
\end{minted}

\pause

Damn\ldots{} That's the ultimate fate of the universe - to collapse.
\end{frame}

\begin{frame}[label={sec:org8f581d6},fragile]{Possible solution}
 \begin{enumerate}
\item <1-> Apply the rule.
\item <2-> Shift original tape left once, apply the rule.
\item <3-> Shift original tape left twice, apply the rule.
\item <4-> \ldots{}
\item <5-> Do the same for the right hand side.
\item <6-> \ldots{}
\item <7-> lists can be infinite
\item <8-> \ldots{}
\item <9-> \texttt{M-x doctor}
\end{enumerate}
\end{frame}

\begin{frame}[label={sec:org4cdef0e}]{M-x doctor}
\begin{verse}
I am the psychotherapist.  Please, describe your problems.  Each time you are\\
finished talking, type RET twice.\\
\vspace*{1em}
Hello\\
\vspace*{1em}
How do you do?  What brings you to see me?\\
\vspace*{1em}
I can't apply ECA rules to the infinite Universe!\\
\vspace*{1em}
Why do you say that?\\
\end{verse}

And he is damn right! We can do it.
\end{frame}

\begin{frame}[label={sec:org086e057},fragile,t]{All possible shifts}
 \begin{onlyenv}<1>
\begin{minted}[]{haskell}
duplicate :: U a -> U (U a)
\end{minted}
\end{onlyenv}

\begin{onlyenv}<2->
\begin{minted}[]{haskell}
duplicate :: U a -> U (U a)
duplicate u = U (tail $ iterate left u) u (tail $ iterate right u)
\end{minted}
\end{onlyenv}

\begin{onlyenv}<3->
$$\forall f: head\ .\ iterate\ f = id$$

\begin{minted}[]{haskell}
> :t iterate
iterate :: (a -> a) -> a -> [a]

> take 3 $ iterate (+1) 0
[0,1,2]
\end{minted}
\end{onlyenv}
\end{frame}

\begin{frame}[label={sec:org6cf9f12}]{All possible shifts}
\begin{gather*}
  \dots\ 0\ 1\ (2)\ 3\ 4\ 5\ \dots \\
  \Downarrow \text{duplicate} \\
  \dots\
  \begin{matrix}
    \vdots & \vdots & \vdots      & \vdots & \vdots & \vdots \\
           &        & \smallfrown &        &        &        \\
    (0)    & 0      & 0           & 0      & 0      & 0      \\
    1      & (1)    & 1           & 1      & 1      & 1      \\
    2      & 2      & (2)         & 2      & 2      & 2      \\
    3      & 3      & 3           & (3)    & 3      & 3      \\
    4      & 4      & 4           & 4      & (4)    & 4      \\
    5      & 5      & 5           & 5      & 5      & (5)    \\
           &        & \smallsmile &        &        &        \\
    \vdots & \vdots & \vdots      & \vdots & \vdots & \vdots \\
  \end{matrix}\
  \dots
\end{gather*}
\end{frame}

\begin{frame}[label={sec:org1211c9b}]{Where's the focus?}
\begin{gather*}
  \dots\ 0\ 1\ (2)\ 3\ 4\ 5\ \dots \\
  \Downarrow \text{left . duplicate} \\
  \dots\
  \begin{matrix}
    \vdots & \vdots      & \vdots & \vdots & \vdots & \vdots \\
           & \smallfrown &        &        &        &        \\
    (0)    & 0           & 0      & 0      & 0      & 0      \\
    1      & (1)         & 1      & 1      & 1      & 1      \\
    2      & 2           & (2)    & 2      & 2      & 2      \\
    3      & 3           & 3      & (3)    & 3      & 3      \\
    4      & 4           & 4      & 4      & (4)    & 4      \\
    5      & 5           & 5      & 5      & 5      & (5)    \\
           & \smallsmile &        &        &        &        \\
    \vdots                                                                                                           & \vdots      & \vdots & \vdots & \vdots & \vdots \\
  \end{matrix}\
  \dots
\end{gather*}
\end{frame}

\begin{frame}[label={sec:orgb234cbb}]{Where's the focus?}
\begin{gather*}
  \dots\ 0\ 1\ (2)\ 3\ 4\ 5\ \dots \\
  \Downarrow \text{right . duplicate} \\
  \dots\
  \begin{matrix}
    \vdots & \vdots & \vdots & \vdots      & \vdots & \vdots \\
           &        &        & \smallfrown &        &        \\
    (0)    & 0      & 0      & 0           & 0      & 0      \\
    1      & (1)    & 1      & 1           & 1      & 1      \\
    2      & 2      & (2)    & 2           & 2      & 2      \\
    3      & 3      & 3      & (3)         & 3      & 3      \\
    4      & 4      & 4      & 4           & (4)    & 4      \\
    5      & 5      & 5      & 5           & 5      & (5)    \\
           &        &        & \smallsmile &        &        \\
    \vdots                                                                                                           & \vdots      & \vdots & \vdots & \vdots & \vdots \\
  \end{matrix}\
  \dots
\end{gather*}
\end{frame}

\begin{frame}[label={sec:org6dad03c}]{Where's focus}
\begin{gather*}
  \dots\ 0\ 1\ (2)\ 3\ 4\ 5\ \dots \\
  \Downarrow \text{fmap left . duplicate} \\
  \dots\
  \begin{matrix}
    \vdots & \vdots & \vdots      & \vdots & \vdots & \vdots \\
           &        & \smallfrown &        &        &        \\
    (0)    & 0      & 0           & 0      & 0      & 0      \\
    1      & (1)    & (1)         & 1      & 1      & 1      \\
    2      & 2      & 2           & 2      & 2      & 2      \\
    3      & 3      & 3           & (3)    & 3      & 3      \\
    4      & 4      & 4           & 4      & (4)    & 4      \\
    5      & 5      & 5           & 5      & 5      & (5)    \\
           &        & \smallsmile &        &        &        \\
    \vdots & \vdots & \vdots      & \vdots & \vdots & \vdots \\
  \end{matrix}\
  \dots
\end{gather*}
\end{frame}

\begin{frame}[label={sec:org5bb1dd1},fragile,t]{\texttt{extend}}
 \begin{onlyenv}<1>
\begin{minted}[]{haskell}
extend :: (U a -> a)
       ->  U a
       ->  U a
\end{minted}
\end{onlyenv}

\begin{onlyenv}<2->
\begin{minted}[]{haskell}
extend :: (U a -> a)
       ->  U a
       ->  U a
extend f = fmap f . duplicate
\end{minted}
\end{onlyenv}

\begin{onlyenv}<3->
\begin{minted}[,escapeinside=||,mathescape=true]{haskell}
> U [Alive, Dead] Alive [Alive, Dead]
|$ \square \blacksquare \blacksquare \blacksquare \square $|

> extend rule110 $ U [Alive, Dead] Alive [Alive, Dead]
|$\blacksquare\blacksquare\square\blacksquare\square$|
\end{minted}
\end{onlyenv}
\end{frame}

\begin{frame}[label={sec:org1be4f6e},fragile]{Iteration}
 \begin{minted}[,escapeinside=||,mathescape=true]{haskell}
> mapM_ (print . narrow 20) . take 20 . iterate (extend rule110) $ fromList Dead [Alive]
|$\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\blacksquare\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square$|
|$\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\blacksquare\blacksquare\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square$|
|$\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\blacksquare\blacksquare\blacksquare\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square$|
|$\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\blacksquare\blacksquare\square\blacksquare\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square$|
|$\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\blacksquare\blacksquare\blacksquare\blacksquare\blacksquare\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square$|
|$\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\blacksquare\blacksquare\square\square\square\blacksquare\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square$|
|$\square\square\square\square\square\square\square\square\square\square\square\square\square\square\blacksquare\blacksquare\blacksquare\square\square\blacksquare\blacksquare\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square$|
|$\square\square\square\square\square\square\square\square\square\square\square\square\square\blacksquare\blacksquare\square\blacksquare\square\blacksquare\blacksquare\blacksquare\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square$|
|$\square\square\square\square\square\square\square\square\square\square\square\square\blacksquare\blacksquare\blacksquare\blacksquare\blacksquare\blacksquare\blacksquare\square\blacksquare\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square$|
|$\square\square\square\square\square\square\square\square\square\square\square\blacksquare\blacksquare\square\square\square\square\square\blacksquare\blacksquare\blacksquare\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square$|
|$\square\square\square\square\square\square\square\square\square\square\blacksquare\blacksquare\blacksquare\square\square\square\square\blacksquare\blacksquare\square\blacksquare\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square$|
|$\square\square\square\square\square\square\square\square\square\blacksquare\blacksquare\square\blacksquare\square\square\square\blacksquare\blacksquare\blacksquare\blacksquare\blacksquare\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square$|
|$\square\square\square\square\square\square\square\square\blacksquare\blacksquare\blacksquare\blacksquare\blacksquare\square\square\blacksquare\blacksquare\square\square\square\blacksquare\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square$|
|$\square\square\square\square\square\square\square\blacksquare\blacksquare\square\square\square\blacksquare\square\blacksquare\blacksquare\blacksquare\square\square\blacksquare\blacksquare\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square$|
|$\square\square\square\square\square\square\blacksquare\blacksquare\blacksquare\square\square\blacksquare\blacksquare\blacksquare\blacksquare\square\blacksquare\square\blacksquare\blacksquare\blacksquare\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square$|
|$\square\square\square\square\square\blacksquare\blacksquare\square\blacksquare\square\blacksquare\blacksquare\square\square\blacksquare\blacksquare\blacksquare\blacksquare\blacksquare\square\blacksquare\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square$|
|$\square\square\square\square\blacksquare\blacksquare\blacksquare\blacksquare\blacksquare\blacksquare\blacksquare\blacksquare\square\blacksquare\blacksquare\square\square\square\blacksquare\blacksquare\blacksquare\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square$|
|$\square\square\square\blacksquare\blacksquare\square\square\square\square\square\square\blacksquare\blacksquare\blacksquare\blacksquare\square\square\blacksquare\blacksquare\square\blacksquare\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square$|
|$\square\square\blacksquare\blacksquare\blacksquare\square\square\square\square\square\blacksquare\blacksquare\square\square\blacksquare\square\blacksquare\blacksquare\blacksquare\blacksquare\blacksquare\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square$|
|$\square\blacksquare\blacksquare\square\blacksquare\square\square\square\square\blacksquare\blacksquare\blacksquare\square\blacksquare\blacksquare\blacksquare\blacksquare\square\square\square\blacksquare\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square\square$|
\end{minted}
\end{frame}

\begin{frame}[label={sec:org9388391},fragile]{Final words}
 \begin{itemize}
\item <1-> Great abstraction of 1D Universe with operations:
\begin{itemize}
\item \texttt{extract}
\item \texttt{duplicate}
\item \texttt{extend}
\item movement
\end{itemize}
\item <2-> ECAa naturally builds on top of the Universe abstraction.
\item <3-> It's easy to implement other automata on top of this abstraction.
\begin{itemize}
\item Different cells (more values)
\item Different rules (more neighbours)
\end{itemize}
\item <4-> Now you understand the first part of the title.
\end{itemize}
\end{frame}

\section{Act 2: Conway's Game of Life}
\label{sec:org6554bee}

\begin{frame}[label={sec:orgd9ac00d}]{Definition}
Two-dimensional cellular automata invented by John H. Conway.

\pause

Each cell has value \(a \in \lbrace 0, 1 \rbrace = \lbrace \square, \blacksquare
\rbrace\)

\pause

Grid is rectangle.

\begin{equation*}
  \begingroup
  \setlength\arraycolsep{0.25pt}
  \renewcommand{\arraystretch}{0.5}
  \begin{matrix}
    \blacksquare & \blacksquare & \blacksquare & \blacksquare & \blacksquare & \blacksquare & \blacksquare & \blacksquare \\
    \square      & \blacksquare & \square      & \blacksquare & \square      & \blacksquare & \square      & \blacksquare \\
    \blacksquare & \square      & \blacksquare & \square      & \blacksquare & \square      & \blacksquare & \square \\
    \blacksquare & \blacksquare & \blacksquare & \blacksquare & \blacksquare & \blacksquare & \blacksquare & \square \\
    \blacksquare & \square      & \blacksquare & \square      & \blacksquare & \blacksquare & \blacksquare & \square \\
    \square      & \blacksquare & \square      & \blacksquare & \square      & \blacksquare & \square      & \blacksquare \\
  \end{matrix}
  \endgroup
\end{equation*}
\end{frame}

\begin{frame}[label={sec:org7f1798f}]{Rules}
\(S \in {0, 1}\) is status of the focus.

\(A\) is amount of living cells around the focus (max \(8\)).

\begin{itemize}
\item Death: if \(A < 2 \vee A > 3 \to 0\).
\item Survival: if \((A = 2 \vee A = 3 \to) \wedge S = 1 \to 1\).
\item Birth: if \(A = 3 \wedge S = 0 \to 1\).
\end{itemize}
\end{frame}

\begin{frame}[label={sec:org2ef80e9}]{Example of simulation (1)}
\begin{footnotesize}
  \begin{equation*}
    \begingroup
    \setlength\arraycolsep{0.25pt}
    \renewcommand{\arraystretch}{0.5}
    \begin{matrix}
      \square      & \square      & \square      & \square      & \square      & \square      & \square \\
      \square      & \blacksquare & \blacksquare & \blacksquare & \blacksquare & \blacksquare & \square \\
      \square      & \blacksquare & \blacksquare & \square      & \blacksquare & \blacksquare & \square \\
      \square      & \blacksquare & \blacksquare & \square      & \blacksquare & \blacksquare & \square \\
      \square      & \blacksquare & \blacksquare & \square      & \blacksquare & \blacksquare & \square \\
      \square      & \blacksquare & \blacksquare & \blacksquare & \blacksquare & \blacksquare & \square \\
      \square      & \square      & \square      & \square      & \square      & \square      & \square \\
    \end{matrix}\Rightarrow
    \begin{matrix}
      \square      & \square      & \blacksquare & \blacksquare & \blacksquare & \square      & \square \\
      \square      & \blacksquare & \square      & \square      & \square      & \blacksquare & \square \\
      \blacksquare & \square      & \square      & \square      & \square      & \square      & \blacksquare \\
      \blacksquare & \square      & \square      & \square      & \square      & \square      & \blacksquare \\
      \blacksquare & \square      & \square      & \square      & \square      & \square      & \blacksquare \\
      \square      & \blacksquare & \square      & \square      & \square      & \blacksquare & \square \\
      \square      & \square      & \blacksquare & \blacksquare & \blacksquare & \square      & \square \\
    \end{matrix}\Rightarrow
    \begin{matrix}
      \square      & \square      & \blacksquare & \blacksquare & \blacksquare & \square      & \square \\
      \square      & \blacksquare & \blacksquare & \blacksquare & \blacksquare & \blacksquare & \square \\
      \blacksquare & \blacksquare & \square      & \square      & \square      & \blacksquare & \blacksquare \\
      \blacksquare & \blacksquare & \square      & \square      & \square      & \blacksquare & \blacksquare \\
      \blacksquare & \blacksquare & \square      & \square      & \square      & \blacksquare & \blacksquare \\
      \square      & \blacksquare & \blacksquare & \blacksquare & \blacksquare & \blacksquare & \square \\
      \square      & \square      & \blacksquare & \blacksquare & \blacksquare & \square      & \square \\
    \end{matrix}\Rightarrow
    \begin{matrix}
      \square      & \blacksquare & \square      & \square      & \square      & \blacksquare & \square \\
      \blacksquare & \square      & \square      & \square      & \square      & \square      & \blacksquare \\
      \square      & \square      & \square      & \blacksquare & \square      & \square      & \square \\
      \square      & \square      & \blacksquare & \square      & \blacksquare & \square      & \square \\
      \square      & \square      & \square      & \blacksquare & \square      & \square      & \square \\
      \blacksquare & \square      & \square      & \square      & \square      & \square      & \blacksquare \\
      \square      & \blacksquare & \square      & \square      & \square      & \blacksquare & \square \\
    \end{matrix}\Rightarrow
    \begin{matrix}
      \square      & \blacksquare & \blacksquare & \blacksquare & \blacksquare & \blacksquare & \square \\
      \blacksquare & \square      & \square      & \square      & \square      & \square      & \blacksquare \\
      \blacksquare & \square      & \square      & \blacksquare & \square      & \square      & \blacksquare \\
      \blacksquare & \square      & \blacksquare & \square      & \blacksquare & \square      & \blacksquare \\
      \blacksquare & \square      & \square      & \blacksquare & \square      & \square      & \blacksquare \\
      \blacksquare & \square      & \square      & \square      & \square      & \square      & \blacksquare \\
      \square      & \blacksquare & \blacksquare & \blacksquare & \blacksquare & \blacksquare & \square \\
    \end{matrix}\Rightarrow
    \begin{matrix}
      \square      & \blacksquare & \square      & \square      & \square      & \blacksquare & \square \\
      \blacksquare & \square      & \square      & \square      & \square      & \square      & \blacksquare \\
      \square      & \square      & \square      & \blacksquare & \square      & \square      & \square \\
      \square      & \square      & \blacksquare & \square      & \blacksquare & \square      & \square \\
      \square      & \square      & \square      & \blacksquare & \square      & \square      & \square \\
      \blacksquare & \square      & \square      & \square      & \square      & \square      & \blacksquare \\
      \square      & \blacksquare & \square      & \square      & \square      & \blacksquare & \square \\
    \end{matrix}\Rightarrow
    \endgroup
  \end{equation*}
\end{footnotesize}

\begin{footnotesize}
  \begin{equation*}
    \mspace{-48mu}
    \begingroup
    \setlength\arraycolsep{0.25pt}
    \renewcommand{\arraystretch}{0.5}
    \Rightarrow\begin{matrix}
      \square      & \blacksquare & \square      & \square      & \square      & \blacksquare & \square \\
      \blacksquare & \square      & \square      & \square      & \square      & \square      & \blacksquare \\
      \square      & \square      & \square      & \blacksquare & \square      & \square      & \square \\
      \square      & \square      & \blacksquare & \square      & \blacksquare & \square      & \square \\
      \square      & \square      & \square      & \blacksquare & \square      & \square      & \square \\
      \blacksquare & \square      & \square      & \square      & \square      & \square      & \blacksquare \\
      \square      & \blacksquare & \square      & \square      & \square      & \blacksquare & \square \\
    \end{matrix}\Rightarrow
    \begin{matrix}
      \square      & \blacksquare & \blacksquare & \square      & \blacksquare & \blacksquare & \square \\
      \blacksquare & \square      & \square      & \square      & \square      & \square      & \blacksquare \\
      \blacksquare & \square      & \square      & \blacksquare & \square      & \square      & \blacksquare \\
      \square      & \square      & \blacksquare & \square      & \blacksquare & \square      & \square \\
      \blacksquare & \square      & \square      & \blacksquare & \square      & \square      & \blacksquare \\
      \blacksquare & \square      & \square      & \square      & \square      & \square      & \blacksquare \\
      \square      & \blacksquare & \blacksquare & \square      & \blacksquare & \blacksquare & \square \\
    \end{matrix}\Rightarrow
    \begin{matrix}
      \square      & \blacksquare & \blacksquare & \blacksquare & \blacksquare & \blacksquare & \square \\
      \blacksquare & \square      & \blacksquare & \blacksquare & \blacksquare & \square      & \blacksquare \\
      \blacksquare & \blacksquare & \square      & \blacksquare & \square      & \blacksquare & \blacksquare \\
      \blacksquare & \blacksquare & \blacksquare & \square      & \blacksquare & \blacksquare & \blacksquare \\
      \blacksquare & \blacksquare & \square      & \blacksquare & \square      & \blacksquare & \blacksquare \\
      \blacksquare & \square      & \blacksquare & \blacksquare & \blacksquare & \square      & \blacksquare \\
      \square      & \blacksquare & \blacksquare & \blacksquare & \blacksquare & \blacksquare & \square \\
    \end{matrix}\Rightarrow
    \begin{matrix}
      \square      & \square      & \square      & \square      & \square      & \square      & \square \\
      \square      & \square      & \square      & \square      & \square      & \square      & \square \\
      \square      & \square      & \square      & \square      & \square      & \square      & \square \\
      \square      & \square      & \square      & \square      & \square      & \square      & \square \\
      \square      & \square      & \square      & \square      & \square      & \square      & \square \\
      \square      & \square      & \square      & \square      & \square      & \square      & \square \\
      \square      & \square      & \square      & \square      & \square      & \square      & \square \\
    \end{matrix}\Rightarrow
    \begin{matrix}
      \square      & \square      & \square      & \square      & \square      & \square      & \square \\
      \square      & \square      & \square      & \square      & \square      & \square      & \square \\
      \square      & \square      & \square      & \square      & \square      & \square      & \square \\
      \square      & \square      & \square      & \square      & \square      & \square      & \square \\
      \square      & \square      & \square      & \square      & \square      & \square      & \square \\
      \square      & \square      & \square      & \square      & \square      & \square      & \square \\
      \square      & \square      & \square      & \square      & \square      & \square      & \square \\
    \end{matrix}\Rightarrow
    \begin{matrix}
      \square      & \square      & \square      & \square      & \square      & \square      & \square \\
      \square      & \square      & \square      & \square      & \square      & \square      & \square \\
      \square      & \square      & \square      & \square      & \square      & \square      & \square \\
      \square      & \square      & \square      & \square      & \square      & \square      & \square \\
      \square      & \square      & \square      & \square      & \square      & \square      & \square \\
      \square      & \square      & \square      & \square      & \square      & \square      & \square \\
      \square      & \square      & \square      & \square      & \square      & \square      & \square \\
    \end{matrix}
    \endgroup
  \end{equation*}
\end{footnotesize}
\end{frame}

\begin{frame}[label={sec:org962d353}]{Example of simulation (2)}
\begin{equation*}
  \begingroup
  \setlength\arraycolsep{0.25pt}
  \renewcommand{\arraystretch}{0.5}
  \begin{matrix}
    \square & \square      & \square      & \square      & \square \\
    \square & \square      & \blacksquare & \square      & \square \\
    \square & \square      & \blacksquare & \square      & \square \\
    \square & \square      & \blacksquare & \square      & \square \\
    \square & \square      & \square      & \square      & \square \\
  \end{matrix}\Rightarrow
  \begin{matrix}
    \square & \square      & \square      & \square      & \square \\
    \square & \square      & \square      & \square      & \square \\
    \square & \blacksquare & \blacksquare & \blacksquare & \square \\
    \square & \square      & \square      & \square      & \square \\
    \square & \square      & \square      & \square      & \square \\
  \end{matrix}\Rightarrow
  \begin{matrix}
    \square & \square      & \square      & \square      & \square \\
    \square & \square      & \blacksquare & \square      & \square \\
    \square & \square      & \blacksquare & \square      & \square \\
    \square & \square      & \blacksquare & \square      & \square \\
    \square & \square      & \square      & \square      & \square \\
  \end{matrix}\Rightarrow
  \begin{matrix}
    \square & \square      & \square      & \square      & \square \\
    \square & \square      & \square      & \square      & \square \\
    \square & \blacksquare & \blacksquare & \blacksquare & \square \\
    \square & \square      & \square      & \square      & \square \\
    \square & \square      & \square      & \square      & \square \\
  \end{matrix}\Rightarrow
  \endgroup
\end{equation*}

\begin{equation*}
  \mspace{-48mu}
  \begingroup
  \setlength\arraycolsep{0.25pt}
  \renewcommand{\arraystretch}{0.5}
  \Rightarrow\begin{matrix}
    \square & \square      & \square      & \square      & \square \\
    \square & \square      & \blacksquare & \square      & \square \\
    \square & \square      & \blacksquare & \square      & \square \\
    \square & \square      & \blacksquare & \square      & \square \\
    \square & \square      & \square      & \square      & \square \\
  \end{matrix}\Rightarrow
  \begin{matrix}
    \square & \square      & \square      & \square      & \square \\
    \square & \square      & \square      & \square      & \square \\
    \square & \blacksquare & \blacksquare & \blacksquare & \square \\
    \square & \square      & \square      & \square      & \square \\
    \square & \square      & \square      & \square      & \square \\
  \end{matrix}\Rightarrow
  \begin{matrix}
    \square & \square      & \square      & \square      & \square \\
    \square & \square      & \blacksquare & \square      & \square \\
    \square & \square      & \blacksquare & \square      & \square \\
    \square & \square      & \blacksquare & \square      & \square \\
    \square & \square      & \square      & \square      & \square \\
  \end{matrix}\Rightarrow
  \begin{matrix}
    \square & \square      & \square      & \square      & \square \\
    \square & \square      & \square      & \square      & \square \\
    \square & \blacksquare & \blacksquare & \blacksquare & \square \\
    \square & \square      & \square      & \square      & \square \\
    \square & \square      & \square      & \square      & \square \\
  \end{matrix}
  \endgroup
\end{equation*}
\end{frame}

\begin{frame}[label={sec:org6548d95}]{Example of simulation (3)}
\begin{tiny}
  \begin{equation*}
    \begingroup
    \setlength\arraycolsep{0.25pt}
    \renewcommand{\arraystretch}{0.5}
    \setcounter{MaxMatrixCols}{17}
    \begin{matrix}
      \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \blacksquare & \blacksquare & \blacksquare & \square & \square & \square & \blacksquare & \blacksquare & \blacksquare & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
      \square & \square & \blacksquare & \square & \square & \square & \square & \blacksquare & \square & \blacksquare & \square & \square & \square & \square & \blacksquare & \square & \square \\
      \square & \square & \blacksquare & \square & \square & \square & \square & \blacksquare & \square & \blacksquare & \square & \square & \square & \square & \blacksquare & \square & \square \\
      \square & \square & \blacksquare & \square & \square & \square & \square & \blacksquare & \square & \blacksquare & \square & \square & \square & \square & \blacksquare & \square & \square \\
      \square & \square & \square & \square & \blacksquare & \blacksquare & \blacksquare & \square & \square & \square & \blacksquare & \blacksquare & \blacksquare & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \blacksquare & \blacksquare & \blacksquare & \square & \square & \square & \blacksquare & \blacksquare & \blacksquare & \square & \square & \square & \square \\
      \square & \square & \blacksquare & \square & \square & \square & \square & \blacksquare & \square & \blacksquare & \square & \square & \square & \square & \blacksquare & \square & \square \\
      \square & \square & \blacksquare & \square & \square & \square & \square & \blacksquare & \square & \blacksquare & \square & \square & \square & \square & \blacksquare & \square & \square \\
      \square & \square & \blacksquare & \square & \square & \square & \square & \blacksquare & \square & \blacksquare & \square & \square & \square & \square & \blacksquare & \square & \square \\
      \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \blacksquare & \blacksquare & \blacksquare & \square & \square & \square & \blacksquare & \blacksquare & \blacksquare & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
    \end{matrix}\Rightarrow
    \begin{matrix}
      \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \blacksquare & \square & \square & \square & \square & \square & \blacksquare & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \blacksquare & \square & \square & \square & \square & \square & \blacksquare & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
      \square & \blacksquare & \blacksquare & \blacksquare & \square & \square & \blacksquare & \blacksquare & \square & \blacksquare & \blacksquare & \square & \square & \blacksquare & \blacksquare & \blacksquare & \square \\
      \square & \square & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \square & \square \\
      \square & \square & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \square & \square \\
      \square & \square & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \square & \square \\
      \square & \blacksquare & \blacksquare & \blacksquare & \square & \square & \blacksquare & \blacksquare & \square & \blacksquare & \blacksquare & \square & \square & \blacksquare & \blacksquare & \blacksquare & \square \\
      \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \blacksquare & \square & \square & \square & \square & \square & \blacksquare & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \blacksquare & \square & \square & \square & \square & \square & \blacksquare & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
    \end{matrix}\Rightarrow
    \begin{matrix}
      \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \square & \square \\
      \square & \square & \blacksquare & \square & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \square & \blacksquare & \square & \square \\
      \square & \square & \blacksquare & \blacksquare & \blacksquare & \square & \blacksquare & \blacksquare & \square & \blacksquare & \blacksquare & \square & \blacksquare & \blacksquare & \blacksquare & \square & \square \\
      \square & \square & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \square & \square \\
      \square & \square & \square & \square & \blacksquare & \blacksquare & \blacksquare & \square & \square & \square & \blacksquare & \blacksquare & \blacksquare & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \blacksquare & \blacksquare & \blacksquare & \square & \square & \square & \blacksquare & \blacksquare & \blacksquare & \square & \square & \square & \square \\
      \square & \square & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \square & \square \\
      \square & \square & \blacksquare & \blacksquare & \blacksquare & \square & \blacksquare & \blacksquare & \square & \blacksquare & \blacksquare & \square & \blacksquare & \blacksquare & \blacksquare & \square & \square \\
      \square & \square & \blacksquare & \square & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \square & \blacksquare & \square & \square \\
      \square & \square & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
    \end{matrix}\Rightarrow
    \endgroup
  \end{equation*}
\end{tiny}

\begin{tiny}
  \begin{equation*}
    \begingroup
    \setlength\arraycolsep{0.25pt}
    \renewcommand{\arraystretch}{0.5}
    \setcounter{MaxMatrixCols}{17}
    \mspace{-48mu}\Rightarrow\begin{matrix}
    \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
    \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
    \square & \square & \square & \square & \blacksquare & \blacksquare & \blacksquare & \square & \square & \square & \blacksquare & \blacksquare & \blacksquare & \square & \square & \square & \square \\
    \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
    \square & \square & \blacksquare & \square & \square & \square & \square & \blacksquare & \square & \blacksquare & \square & \square & \square & \square & \blacksquare & \square & \square \\
    \square & \square & \blacksquare & \square & \square & \square & \square & \blacksquare & \square & \blacksquare & \square & \square & \square & \square & \blacksquare & \square & \square \\
    \square & \square & \blacksquare & \square & \square & \square & \square & \blacksquare & \square & \blacksquare & \square & \square & \square & \square & \blacksquare & \square & \square \\
    \square & \square & \square & \square & \blacksquare & \blacksquare & \blacksquare & \square & \square & \square & \blacksquare & \blacksquare & \blacksquare & \square & \square & \square & \square \\
    \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
    \square & \square & \square & \square & \blacksquare & \blacksquare & \blacksquare & \square & \square & \square & \blacksquare & \blacksquare & \blacksquare & \square & \square & \square & \square \\
    \square & \square & \blacksquare & \square & \square & \square & \square & \blacksquare & \square & \blacksquare & \square & \square & \square & \square & \blacksquare & \square & \square \\
    \square & \square & \blacksquare & \square & \square & \square & \square & \blacksquare & \square & \blacksquare & \square & \square & \square & \square & \blacksquare & \square & \square \\
    \square & \square & \blacksquare & \square & \square & \square & \square & \blacksquare & \square & \blacksquare & \square & \square & \square & \square & \blacksquare & \square & \square \\
    \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
    \square & \square & \square & \square & \blacksquare & \blacksquare & \blacksquare & \square & \square & \square & \blacksquare & \blacksquare & \blacksquare & \square & \square & \square & \square \\
    \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
    \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
    \end{matrix}\Rightarrow
    \begin{matrix}
      \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \blacksquare & \square & \square & \square & \square & \square & \blacksquare & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \blacksquare & \square & \square & \square & \square & \square & \blacksquare & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
      \square & \blacksquare & \blacksquare & \blacksquare & \square & \square & \blacksquare & \blacksquare & \square & \blacksquare & \blacksquare & \square & \square & \blacksquare & \blacksquare & \blacksquare & \square \\
      \square & \square & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \square & \square \\
      \square & \square & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \square & \square \\
      \square & \square & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \square & \square \\
      \square & \blacksquare & \blacksquare & \blacksquare & \square & \square & \blacksquare & \blacksquare & \square & \blacksquare & \blacksquare & \square & \square & \blacksquare & \blacksquare & \blacksquare & \square \\
      \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \blacksquare & \square & \square & \square & \square & \square & \blacksquare & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \blacksquare & \square & \square & \square & \square & \square & \blacksquare & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
    \end{matrix}\Rightarrow
    \begin{matrix}
      \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \square & \square \\
      \square & \square & \blacksquare & \square & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \square & \blacksquare & \square & \square \\
      \square & \square & \blacksquare & \blacksquare & \blacksquare & \square & \blacksquare & \blacksquare & \square & \blacksquare & \blacksquare & \square & \blacksquare & \blacksquare & \blacksquare & \square & \square \\
      \square & \square & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \square & \square \\
      \square & \square & \square & \square & \blacksquare & \blacksquare & \blacksquare & \square & \square & \square & \blacksquare & \blacksquare & \blacksquare & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \blacksquare & \blacksquare & \blacksquare & \square & \square & \square & \blacksquare & \blacksquare & \blacksquare & \square & \square & \square & \square \\
      \square & \square & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \square & \square \\
      \square & \square & \blacksquare & \blacksquare & \blacksquare & \square & \blacksquare & \blacksquare & \square & \blacksquare & \blacksquare & \square & \blacksquare & \blacksquare & \blacksquare & \square & \square \\
      \square & \square & \blacksquare & \square & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \blacksquare & \square & \square & \blacksquare & \square & \square \\
      \square & \square & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \square & \square & \blacksquare & \blacksquare & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
      \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square & \square \\
    \end{matrix}
    \endgroup
  \end{equation*}
\end{tiny}
\end{frame}

\begin{frame}[label={sec:org688c9c0}]{\emph{untitled copy (1)(2) - final}}
\begin{onlyenv}<1>
iTunes anyone?
\end{onlyenv}

\begin{onlyenv}<2>
\begin{center}
\includegraphics[height=7cm]{images/u2.png}
\end{center}
\end{onlyenv}
\end{frame}

\begin{frame}[label={sec:org9e5855b},fragile]{Rolling out U2}
 \begin{minted}[]{haskell}
type U2 a = U (U a)
\end{minted}
\end{frame}

\begin{frame}[label={sec:orgf9d359f},fragile]{Moving around in the \sout{complex} Universe}
 \begin{minted}[]{haskell}
shift :: Direction -> U2 a -> U2 a
shift North u = left      u
shift South u = right     u
shift East  u = right <$> u
shift West  u = left  <$> u
\end{minted}

\begin{columns}
\begin{column}{0.45\columnwidth}
\begin{onlyenv}<2->
\begin{minted}[,escapeinside=||,mathescape=true]{haskell}
> print' DisplayFocused . narrow2 3 $ gof1
|$\ \square\square\square[\square]\square\square\square$|
|$\ \square\square\square[\square]\square\square\square$|
|$\ \square\square\square[\square]\square\square\square$|
|$[\square\square\square\ \square\ \square\square\square]$|
|$\ \square\square\square[\square]\blacksquare\blacksquare\blacksquare$|
|$\ \square\square\square[\square]\blacksquare\blacksquare\square$|
|$\ \square\square\square[\square]\blacksquare\blacksquare\square$|
\end{minted}
\end{onlyenv}
\end{column}

\begin{column}{0.45\columnwidth}
\begin{onlyenv}<3>
\begin{minted}[,escapeinside=||,mathescape=true]{haskell}
> (...) . shift North $ gof1
|$\ \square\square\square[\square]\square\square\square$|
|$\ \square\square\square[\square]\square\square\square$|
|$\ \square\square\square[\square]\square\square\square$|
|$[\square\square\square\ \square\ \square\square\square]$|
|$\ \square\square\square[\square]\square\square\square$|
|$\ \square\square\square[\square]\blacksquare\blacksquare\blacksquare$|
|$\ \square\square\square[\square]\blacksquare\blacksquare\square$|
\end{minted}
\end{onlyenv}

\begin{onlyenv}<4>
\begin{minted}[,escapeinside=||,mathescape=true]{haskell}
> (...) . shiftn 3 South . shiftn 3 East $ gof1
|$\ \square\square\square[\square]\square\square\square$|
|$\ \square\blacksquare\blacksquare[\blacksquare]\blacksquare\blacksquare\square$|
|$\ \square\blacksquare\blacksquare[\square]\blacksquare\blacksquare\square$|
|$[\square\blacksquare\blacksquare\ \square\ \blacksquare\blacksquare\square]$|
|$\ \square\blacksquare\blacksquare[\square]\blacksquare\blacksquare\square$|
|$\ \square\blacksquare\blacksquare[\blacksquare]\blacksquare\blacksquare\square$|
|$\ \square\square\square[\square]\square\square\square$|
\end{minted}
\end{onlyenv}
\end{column}
\end{columns}
\end{frame}

\begin{frame}[label={sec:orgb9a82ed},fragile]{Game of Life rules}
 \begin{minted}[]{haskell}
rule :: U (U Cell) -> Cell
rule u | ns == 3   = Alive
       | ns == 2   = extract . extract $ u
       | otherwise = Dead
  where ns = length . filter (== Alive) . neighbours Dead $ u

--------------------------------------------------------------------------------

neighbours :: Cell -> U (U Cell) -> [Cell]
neighbours c u
  = fmap (\f -> extract . extract $ f u)
    [ shift North
    , shift North . shift East
    , shift East
    , shift East . shift South
    , shift South
    , shift South . shift West
    , shift West
    , shift West . shift North
    ]
\end{minted}
\end{frame}

\begin{frame}[label={sec:orgcac5ca8},fragile]{Was easy, right?}
 \begin{minted}[]{haskell}
> let someGof = undefined :: U (U Cell)
\end{minted}

\pause

\begin{minted}[]{haskell}
> :t rule someGof
rule someGof :: Cell
\end{minted}

\pause

\begin{minted}[]{haskell}
> :t extend rule someGof
extend rule someGof :: U Cell
\end{minted}

\pause

Wait\ldots{} WAT?
\end{frame}

\begin{frame}[label={sec:org5473604},fragile]{Extending 2D Universe (1)}
 \begin{minted}[]{haskell}
> :t extend
extend :: (U a -> b) -> U a -> U b
\end{minted}

\pause

\begin{minted}[]{haskell}
> :t extend rule
extend rule' :: U (U Cell) -> U Cell
\end{minted}

\pause

But we need \texttt{extend2 :: (U (U a) -> b) - U (U a) -> U (U b)}.
\end{frame}

\begin{frame}[label={sec:orgbea1f36},fragile]{Extending 2D Universe (2)}
 \begin{minted}[]{haskell}
duplicate2 :: U (U a) -> U (U (U (U a)))
duplicate2 = fmap duplicate . duplicate

extend2 :: (U (U a) -> b) -> U (U a) -> U (U b)
extend2 f = fmap (fmap f) . duplicate2
\end{minted}

\pause

\begin{equation*}
  \begingroup
  \setlength\arraycolsep{0.25pt}
  \renewcommand{\arraystretch}{0.5}
  \begin{matrix}
    \square & \square & \square      & \square      & \square \\
    \square & \square & \blacksquare & \square      & \square \\
    \square & \square & \blacksquare & \square      & \square \\
    \square & \square & \blacksquare & \square      & \square \\
    \square & \square & \square      & \square      & \square \\
  \end{matrix}\Rightarrow
  \begin{matrix}
    \square & \square & \square & \square & \square \\
    \square & \square & \square & \square & \square \\
    \square & \square & \square & \square & \square \\
    \square & \square & \square & \square & \square \\
    \square & \square & \square & \square & \square \\
  \end{matrix}\ne
  \begin{matrix}
    \square & \square      & \square      & \square      & \square \\
    \square & \square      & \square      & \square      & \square \\
    \square & \blacksquare & \blacksquare & \blacksquare & \square \\
    \square & \square      & \square      & \square      & \square \\
    \square & \square      & \square      & \square      & \square \\
  \end{matrix}
  \endgroup
\end{equation*}

\pause

fmap-fu can't always save you, functor-kun!
\end{frame}

\begin{frame}[label={sec:org9b79f64},fragile]{Extending 2D Universe}
 \begin{minted}[]{haskell}
newtype U2 a
  = U2
  { getUniverse :: U (U a)
  } deriving (Functor)

extract :: U2 a -> a
extract = extract . extract . getUniverse

duplicate :: U2 a -> U2 (U2 a)
duplicate = fmap U2 . U2 . shifted . shifted . getUniverse
  where shifted :: U (U a) -> U (U (U a))
        shifted u@(U _ (U ls _ rs) _) = U
          (tail $ iterate (fmap left) u)
          u
          (tail $ iterate (fmap right) u)

extend :: (U2 a -> a) -> U2 a -> U2 a
extend f = fmap f . duplicate
\end{minted}
\end{frame}

\begin{frame}[label={sec:org3d03f74},fragile]{Works}
 \begin{minted}[,escapeinside=||,mathescape=true]{haskell}
> mapM_ (print . narrow2' 0 4 0 4) . take 2 . iterate (extend rule) $ gof3
|$\square\square\square\square\square$|
|$\square\square\blacksquare\square\square$|
|$\square\square\blacksquare\square\square$|
|$\square\square\blacksquare\square\square$|
|$\square\square\square\square\square$|
|$$|
|$\square\square\square\square\square$|
|$\square\square\square\square\square$|
|$\square\blacksquare\blacksquare\blacksquare\square$|
|$\square\square\square\square\square$|
|$\square\square\square\square\square$|
\end{minted}
\end{frame}

\begin{frame}[label={sec:orgd2396cd}]{Final words}
\begin{itemize}
\item <1-> Moving from 1D to 2D is really simple (not counting the wasted time on the
wrong idea).
\item <2-> Great abstraction for our task.
\item <3-> It's easy to implement other automata on top of this abstraction.
\begin{itemize}
\item Different cells (more values)
\item Different rules (more neighbours)
\end{itemize}
\end{itemize}
\end{frame}

\section{Act 3: Bomberman}
\label{sec:orga8b783b}

\begin{frame}[label={sec:org0585abe}]{Definition}
\pause

Do you really need a definition of Bomberman?
\end{frame}

\begin{frame}[label={sec:org2f45bfc}]{Definition}
\begin{center}
\includegraphics[width=.9\linewidth]{images/bomberman-1.jpg}
\end{center}
\end{frame}

\begin{frame}[label={sec:org0961c2c}]{But we have a different one}
\begin{center}
\includegraphics[height=8cm]{images/bomberman-2.png}
\end{center}
\end{frame}

\begin{frame}[label={sec:orgc23ea51}]{Bells and whistles}
\begin{center}
\includegraphics[height=8cm]{images/bomberman-3.png}
\end{center}
\end{frame}

\begin{frame}[label={sec:org8c41ae0},fragile]{Reusing U2}
 \begin{minted}[]{haskell}
data Cell
  = Bomberman
  | BombBomberman
  | DeadBomberman

  | OtherBomberman
  | OtherBombBomberman
  | OtherDeadBomberman

  | BombTimer5
  | BombTimer4
  | BombTimer3
  | BombTimer2
  | BombTimer1
  | Boom

  | Wall
  | DestroyableWall
  | DestroyedWall

  | MeatChopper
  | DeadMeatChopper

  | Empty
\end{minted}
\end{frame}

\begin{frame}[label={sec:org0a55408},fragile]{What is bot?}
 \begin{minted}[]{haskell}
bot :: ( MonadIO m
       , MonadReader r m
       , HasLogFunc r
       )
    => U2 Cell
    -> m Action
bot = undefined
\end{minted}

\pause

What to \texttt{extend}?
\end{frame}

\begin{frame}[label={sec:orgadd1f26}]{What we care about}
\begin{itemize}
\item <1-> Greed. What can be destroyed?
\item <2-> Safety. What can kill us?
\end{itemize}
\end{frame}

\begin{frame}[label={sec:orgff8aea1},fragile]{Fatum of the Universe}
 \begin{minted}[]{haskell}
data MarkedCell
  = MarkedCell
  { getCell        :: !Cell
  , getDangers     :: ![Cell]
  , getTargets     :: ![Cell]
  }
\end{minted}

\pause

\begin{minted}[]{haskell}
mark :: U2 Cell -> MarkedCell
mark board = MarkedCell (extract board) dangers targets
  where dangers = bombs <> monsters
        bombs = filter isBomb (allVisible (not . isAnyWall) 3 board)
        monsters = filter (isMonster .| isEnemy) (allVisible (not . isAnyWall) 1 board)

        targets
          = filter (isDestroyableWall .| isMonster .| isEnemy)
          $ allVisible (not . isWall) 3 board
\end{minted}
\end{frame}

\begin{frame}[label={sec:org38826a8},fragile]{Fatum of the Universe}
 \begin{minted}[]{haskell}
> :t extend
extend :: (U2 a -> b) -> U2 a -> U2 b

> :t extend mark
extend mark :: U2 Cell -> U2 MarkedCell
\end{minted}
\end{frame}

\begin{frame}[label={sec:orgf9f4d3f},fragile,t]{The bot}
 \begin{onlyenv}<1>
\begin{minted}[]{haskell}
bot :: ( MonadIO m
       , MonadReader r m
       , HasLogFunc r
       )
    => U2 Cell
    -> m Action
bot board = do
  let markedBoard = extend mark $ narrow 11 board
  ...
\end{minted}
\end{onlyenv}

\begin{onlyenv}<2>
\begin{minted}[]{haskell}
bot :: ( MonadIO m
       , MonadReader r m
       , HasLogFunc r
       )
    => U2 Cell
    -> m Action
bot board = do
  let markedBoard = extend mark $ narrow 11 board
      directions  = if isSafe . extract $ markedBoard
                    then ...
                    else ...
  ...

isSafe :: MarkedCell -> Bool
isSafe = L.null . getDangers
\end{minted}
\end{onlyenv}

\begin{onlyenv}<3>
\begin{minted}[]{haskell}
bot :: ( MonadIO m
       , MonadReader r m
       , HasLogFunc r
       )
    => U2 Cell
    -> m Action
bot board = do
  let markedBoard = extend mark $ narrow 11 board
      directions  = if isSafe . extract $ markedBoard
                    then directionsToTargets markedBoard
                    else escapeDirections markedBoard
  ...

isSafe :: MarkedCell -> Bool
isSafe = L.null . getDangers
\end{minted}
\end{onlyenv}

\begin{onlyenv}<4>
\begin{minted}[]{haskell}
bot :: ( MonadIO m
       , MonadReader r m
       , HasLogFunc r
       )
    => U2 Cell
    -> m Action
bot board = do
  let markedBoard = extend mark $ narrow 11 board
      directions  = if isSafe . extract $ markedBoard
                    then directionsToTargets markedBoard
                    else escapeDirections markedBoard
  direction <- randomElement directions
  ...

isSafe :: MarkedCell -> Bool
isSafe = L.null . getDangers
\end{minted}
\end{onlyenv}

\begin{onlyenv}<5>
\begin{minted}[]{haskell}
bot :: ( MonadIO m
       , MonadReader r m
       , HasLogFunc r
       )
    => U2 Cell
    -> m Action
bot board = do
  let markedBoard = extend mark $ narrow 11 board
      directions  = if isSafe . extract $ markedBoard
                    then directionsToTargets markedBoard
                    else escapeDirections markedBoard
  direction <- randomElement directions
  let bomb = shouldBomb markedBoard direction
  ...

isSafe :: MarkedCell -> Bool
isSafe = L.null . getDangers
\end{minted}
\end{onlyenv}

\begin{onlyenv}<6>
\begin{minted}[]{haskell}
bot :: ( MonadIO m
       , MonadReader r m
       , HasLogFunc r
       )
    => U2 Cell
    -> m Action
bot board = do
  let markedBoard = extend mark $ narrow 11 board
      directions  = if isSafe . extract $ markedBoard
                    then directionsToTargets markedBoard
                    else escapeDirections markedBoard
  direction <- randomElement directions
  let bomb = shouldBomb markedBoard direction
  pure $ maybe (Action Stay bomb) (flip Action bomb . Move) direction

isSafe :: MarkedCell -> Bool
isSafe = L.null . getDangers
\end{minted}
\end{onlyenv}
\end{frame}

\begin{frame}[label={sec:org7cf4784}]{Danger! Live demo}
\emph{Live demos are subject to fail. Accept and forgive. Move on.}
\end{frame}

\begin{frame}[label={sec:org48ba263}]{Final words}
\begin{itemize}
\item <1-> Great abstraction for our task. Again.
\begin{itemize}
\item We care about elements surrounding player.
\item Easy to mark all the interesting points to be used in our bot logic.
\end{itemize}
\item <2-> Not all topics are covered.
\begin{itemize}
\item Path finding. Data type helps us here.
\item Being a smart bot.
\end{itemize}
\item <3-> Now you understand the last bit of the title.
\item <4-> Do you think we are done?
\end{itemize}
\end{frame}

\section{Act 4: Comonads}
\label{sec:orgab3fb9d}

\begin{frame}[label={sec:orgcd8f869},fragile]{Builder}
 \begin{minted}[]{haskell}
type Option = String

data Config = MkConfig [Option] deriving (Show)
\end{minted}

\pause

\begin{minted}[]{haskell}
mkConfig :: [Option] -> Config
mkConfig = MkConfig

defaultConfig :: [Option] -> Config
defaultConfig options = MkConfig ("-Wall" : options)
\end{minted}
\end{frame}

\begin{frame}[label={sec:org3b12091},fragile]{Composing builders (1)}
 \begin{minted}[]{haskell}
builder :: [Option] -> Config
\end{minted}

\pause

\begin{minted}[]{haskell}
profile :: ([Option] -> Config) -> Config
profile builder = builder ["-prof", "-auto-all"]
\end{minted}

\pause

\begin{minted}[]{haskell}
> profile defaultConfig
MkConfig ["-Wall","-prof","-auto-all"]
\end{minted}
\end{frame}

\begin{frame}[label={sec:org97244a8},fragile]{Composing builders (2)}
 \begin{minted}[]{haskell}
fullOpt :: ([Option] -> Config) -> Config
fullOpt builder = builder ["-O2"]
\end{minted}

\pause

\begin{minted}[]{haskell}
> fullOpt defaultConfig
MkConfig ["-Wall","-O2"]
\end{minted}

\pause

But how to compose \texttt{fullOpt} and \texttt{profile}?
\end{frame}

\begin{frame}[label={sec:org7976fe9},fragile]{Cheating}
 \begin{minted}[]{haskell}
profile'  :: ([Option] -> Config) -> ([Option] -> Config)
profile' builder =
    \options -> builder (["-prof", "-auto-all"] ++ options)

fullOpt' :: ([Option] -> Config) -> ([Option] -> Config)
fullOpt' builder =
    \options -> builder (["-O2"] ++ options)
\end{minted}

\pause

\begin{minted}[]{haskell}
> :t profile' . fullOpt'
profile' . fullOpt' :: ([Option] -> Config) -> [Option] -> Config

> :t profile' . fullOpt' $ defaultConfig
profile' . fullOpt' $ defaultConfig :: [Option] -> Config
\end{minted}
\end{frame}

\begin{frame}[label={sec:org1edd5f4},fragile]{Extracting}
 \begin{minted}[]{haskell}
extract :: ([Option] -> Config) -> Config
extract builder = builder []
\end{minted}

\pause

\begin{minted}[]{haskell}
> :t extract . profile' . fullOpt' $ defaultConfig
extract . profile' . fullOpt' $ defaultConfig :: Config
\end{minted}

\pause

\begin{minted}[]{haskell}
> extract . profile' . fullOpt' $ defaultConfig
MkConfig ["-Wall","-O2","-prof","-auto-all"]
\end{minted}
\end{frame}

\begin{frame}[label={sec:org49dbfe2},fragile]{Setter}
 \begin{minted}[]{haskell}
profile :: ([Option] -> Config) -> Config
profile builder = builder ["-prof", "-auto-all"]
\end{minted}

This looks better than promoted version:

\begin{minted}[]{haskell}
profile'  :: ([Option] -> Config) -> ([Option] -> Config)
profile' builder =
    \options -> builder (["-prof", "-auto-all"] ++ options)
\end{minted}
\end{frame}

\begin{frame}[label={sec:orgcf2a40d},fragile]{Cheating again}
 \begin{minted}[]{haskell}
-- raw setter
setter :: ([Option] -> Config) -> Config
\end{minted}

\pause

\begin{minted}[]{haskell}
-- promoted setter
extend setter :: ([Option] -> Config) -> ([Option] -> Config)
\end{minted}

\pause

\begin{minted}[]{haskell}
-- setter promotion
extend :: (([Option] -> Config) ->              Config)
       ->  ([Option] -> Config) -> ([Option] -> Config)
\end{minted}
\end{frame}

\begin{frame}[label={sec:orgda8a756},fragile]{\texttt{extend}}
 \begin{minted}[]{haskell}
extend :: (([Option] -> Config) ->              Config)
       ->  ([Option] -> Config) -> ([Option] -> Config)
extend setter builder =
    \opts2 -> setter (\opts1 -> builder (opts1 <> opts2))
\end{minted}

\pause

\begin{minted}[]{haskell}
> :t extract . extend profile
extract . extend profile :: ([Option] -> Config) -> Config
\end{minted}

\pause

\begin{minted}[]{haskell}
> :t extract . extend profile . extend fullOpt
extract . extend profile . extend fullOpt :: ([Option] -> Config) -> Config
\end{minted}

\pause

\begin{minted}[]{haskell}
> extract . extend profile . extend fullOpt $ defaultConfig
MkConfig ["-Wall","-prof","-auto-all","-O2"]
\end{minted}

\pause

\begin{minted}[]{haskell}
> defaultConfig =>> profile =>> fullOpt # extract
MkConfig ["-Wall","-O2","-prof","-auto-all"]

> defaultConfig =>> profile =>> fullOpt $ ["-boris"]
MkConfig ["-Wall","-boris","-O2","-prof","-auto-all"]
\end{minted}
\end{frame}

\begin{frame}[label={sec:orgca00f2a},fragile]{Commonalities (1)}
 \begin{minted}[]{haskell}
extract :: U a  -> a
extract :: U2 a -> a
\end{minted}

\pause

\begin{minted}[]{haskell}
extract :: ([Option] -> Config) -> Config
\end{minted}

\pause

\begin{minted}[]{haskell}
extract :: ((->) [Option]) Config -> Config
\end{minted}

\pause

\begin{minted}[]{haskell}
extract :: f a -> a
\end{minted}
\end{frame}

\begin{frame}[label={sec:org67509b3},fragile]{Commonalities (2)}
 \begin{minted}[]{haskell}
extend :: (U a -> b) -> U a  -> U a
extend :: (U2 a -> b) -> U2 a -> U2 b
\end{minted}

\pause

\begin{minted}[]{haskell}
extend :: (([Option] -> Config) ->              Config)
       ->  ([Option] -> Config) -> ([Option] -> Config)
\end{minted}

\pause

\begin{minted}[]{haskell}
extend :: (((->) [Option]) Config -> Config)
       ->  ((->) [Option]) Config
       ->  ((->) [Option]) Config
\end{minted}

\pause

\begin{minted}[]{haskell}
extend :: (f a -> b) -> f a -> f b
\end{minted}
\end{frame}

\begin{frame}[label={sec:org4a70465},fragile]{Comonad}
 \begin{minted}[]{haskell}
class Functor f => Comonad f where
  extract :: f a -> a
  extend :: (f a -> b) -> f a -> f b
  duplicate :: f a -> f (f a)
\end{minted}

\pause

\texttt{Comonad} laws:

\begin{minted}[]{haskell}
extend extract      = id
extract . extend f  = f
extend f . extend g = extend (f . extend g)
\end{minted}
\end{frame}

\begin{frame}[label={sec:orgbffa3cc},fragile]{Co-monad}
 \begin{columns}
\begin{column}{0.45\columnwidth}
\begin{minted}[]{haskell}
extract :: f a -> a
(=>>) :: f a -> (f a -> b) -> f b
\end{minted}
\end{column}

\begin{column}{0.45\columnwidth}
\begin{minted}[]{haskell}
return :: a -> f a
(>>=) :: f a -> (a -> f b) -> f b
\end{minted}
\end{column}
\end{columns}
\end{frame}

\begin{frame}[label={sec:org60df8eb}]{Universe is Comonad}
That should be obvious by now.
\end{frame}

\begin{frame}[label={sec:org6f29ec4},fragile]{Store}
 \begin{minted}[]{haskell}
data Store s a = Store (s -> a) s

extract (Store f s) = f s

duplicate (Store f s) = Store (Store f) s
\end{minted}

\pause

\emph{Homework:} solve ECA and GOF using \texttt{Store} data type.
\end{frame}

\begin{frame}[label={sec:orge977b3e}]{Many uses}
\begin{itemize}
\item <1-> Instances
\begin{itemize}
\item Pointed lists (Universe)
\item Functions returning monoids.
\item Store
\end{itemize}
\item <2-> Problems
\begin{itemize}
\item Cellular automata.
\item Discrete board games.
\item Builder patter.
\item Iterator pattern.
\item Command pattern.
\item FRP.
\end{itemize}
\end{itemize}
\end{frame}

\begin{frame}[label={sec:orgac1757a}]{Final words}
\begin{itemize}
\item <1-> Comonads give us an interface for extracting and extending certain data
types.
\item <2-> They also provide a 'method' like notation to Haskell.
\item <3-> Comonads are flipped Monads.
\item <4-> Using this interface we solved 3 different problems.
\end{itemize}
\end{frame}

\begin{frame}[label={sec:orge203865}]{Grab the code}
\url{https://gitlab.com/d12frosted/talks}
\end{frame}

\section*{References}
\label{sec:orged95828}
\begin{frame}[label={sec:org32b43e5}]{References}
\begin{itemize}
\item \url{https://www.st.cs.uni-saarland.de/edu/seminare/2005/advanced-fp/docs/huet-zipper.pdf}
\item \url{http://mathworld.wolfram.com/CellularAutomaton.html}
\item \url{http://mathworld.wolfram.com/ElementaryCellularAutomaton.html}
\item \url{http://mathworld.wolfram.com/GameofLife.html}
\item \url{https://hackage.haskell.org/package/comonad}
\item \url{https://bartoszmilewski.com/2017/01/02/comonads/}
\item \url{http://blog.sigfpe.com/2006/12/evaluating-cellular-automata-is.html}
\item \url{http://www.haskellforall.com/2013/02/you-could-have-invented-comonads.html}
\end{itemize}
\end{frame}

\section{Questions?}
\label{sec:org028f27c}
\section{Thank you}
\label{sec:org6d3031a}
\end{document}
